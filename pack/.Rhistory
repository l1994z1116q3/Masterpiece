loser_list <- filter(rank, cum_rank>(n()-200))$symbol
data_now  %>%
select(-top.1500, -m.ind, -id, -year) %>%
filter(symbol %in% winner_list) %>%
group_by(symbol) %>%
arrange(symbol, v.date) %>%
mutate(cum_ret = cumprod(1+tret) - 1) %>%
filter(row_number(v.date) == n()) -> return1
mean(return1$cum_ret) -> result1
data_now  %>%
select(-top.1500, -m.ind, -id, -year) %>%
filter(symbol %in% loser_list_list) %>%
group_by(symbol) %>%
arrange(symbol, v.date) %>%
mutate(cum_ret = cumprod(1+tret) - 1) %>%
filter(row_number(v.date) == n()) -> return2
mean(return2$cum_ret) -> result2
result <- c(result1, result2)
result1
return1
data_now  %>%
select(-top.1500, -m.ind, -id, -year) %>%
filter(symbol %in% loser_list) %>%
group_by(symbol) %>%
arrange(symbol, v.date) %>%
mutate(cum_ret = cumprod(1+tret) - 1) %>%
filter(row_number(v.date) == n()) -> return2
mean(return2$cum_ret) -> result2
result <- c(result1, result2)
result
a <- JT.6.6.Return(2000, 7, 1, data)
JT.6.6.Return <- function(yyyy, mm, pro, data) {
data1 <- Top.1500(yyyy, mm, pro, data)
data2 <- Data.6.6(yyyy, mm, pro, data1)
data_now <- filter(data1,
month==mm,
year==yyyy)
rank <- JT.Index(data2)
winner_list <- filter(rank, cum_rank<=200)$symbol
loser_list <- filter(rank, cum_rank>(n()-200))$symbol
data_now  %>%
select(-top.1500, -m.ind, -id, -year) %>%
filter(symbol %in% winner_list) %>%
group_by(symbol) %>%
arrange(symbol, v.date) %>%
mutate(cum_ret = cumprod(1+tret) - 1) %>%
filter(row_number(v.date) == n()) -> return1
mean(return1$cum_ret) -> result1
data_now  %>%
select(-top.1500, -m.ind, -id, -year) %>%
filter(symbol %in% loser_list) %>%
group_by(symbol) %>%
arrange(symbol, v.date) %>%
mutate(cum_ret = cumprod(1+tret) - 1) %>%
filter(row_number(v.date) == n()) -> return2
mean(return2$cum_ret) -> result2
result <- c(result1, result2)
invisible(result)
}
a <- JT.6.6.Return(2000, 7, 1, data)
a
a <- JT.6.6.Return(2000, 7, 2, data)
a
52High.Index <- function(data) {
data %>%
select(-top.1500, -m.ind, -id, -year) %>%
group_by(symbol) %>%
arrange(symbol, v.date) %>%
mutate(highest = max(price)) %>%
filter(row_number(v.date)==n()) %>%
mutate(index = price/highest, index_rank = min_rank(index)) %>%
select(symbol, index, index_rank) -> z3
invisible(z3)
}
High.Index <- function(data) {
data %>%
select(-top.1500, -m.ind, -id, -year) %>%
group_by(symbol) %>%
arrange(symbol, v.date) %>%
mutate(highest = max(price)) %>%
filter(row_number(v.date)==n()) %>%
mutate(index = price/highest, index_rank = min_rank(index)) %>%
select(symbol, index, index_rank) -> z3
invisible(z3)
}
52High.Index <- function(data) {
52High
52.High.Index <- function(data) {
yyyy=2000
mm=7
pro=1
data <- Select.Data(yyyy, mm)
JT.6.6.Return(yyyy,mm,1,data)
a <- JT.6.6.Return(yyyy,mm,1,data)
a
k <- NULL
for (pro in 1:6) {}
for (pro in 1:6) {}
return_table <- NULL
for (pro in 1:6) {
a <- (a + JT.6.6.Return(yyyy,mm,pro,data))}
a
a/6
a <- 0
for (pro in 1:6) {
a <- (a + JT.6.6.Return(yyyy,mm,pro,data))}
a
a/6
JT.Year.Return <- function(yyyy,data) {
return_table <- NULL
for (i in 1:12) {
mm <- i
for (pro in 1:6) {
a <- JT.6.6.Return(yyyy,mm,pro,data)
return_table <- rbind(return_table, a)
}
}
return(return_table)
}
mmmm <- JT.Year.Return(2000,data)
mmmm
dim(mmmm)
mean(mmmm)
mean(mmmm[1])
mean(mmmm[2])
mean(mmmm[3])
mean(mmmm[,1])
mean(mmmm[,2])
JT.Year.Return <- function(yyyy) {
data <- Select.Data(yyyy, 01)
return_table <- NULL
for (i in 1:12) {
mm <- i
for (pro in 1:6) {
a <- JT.6.6.Return(yyyy,mm,pro,data)
return_table <- rbind(return_table, a)
}
}
return(return_table)
}
mmmm <- JT.Year.Return(2001)
data("daily.2001")
mmmm <- JT.Year.Return(2001)
mmmm
mean(mmmm[,1])
mean(mmmm[,2])
mean_ret <- c(mean(mmmm[,1]),mean(mmmm[,2]))
mean_ret
for(yyyy in 2000:2007) {
)
total <- NULL
for(yyyy in 2000:2007) {
total <- rbind(total, JT.Year.Return(yyyy))
}
data("daily.1998")
Import <- function() {
data(secref)
data(yearly)
data("daily.1998")
data("daily.1999")
data("daily.2000")
data("daily.2001")
data("daily.2002")
data("daily.2003")
data("daily.2004")
data("daily.2005")
data("daily.2006")
data("daily.2007")
}
Import()
rm(avail,data,data_now,data1,data2,mmmm,rank,return1,return2,z3)
total <- NULL
JT.Year.Return <- function(yyyy) {
data <- Select.Data(yyyy, 01)
return_table <- NULL
for (i in 1:12) {
mm <- i
for (pro in 1:6) {
a <- JT.6.6.Return(yyyy,mm,pro,data)
return_table <- rbind(return_table, a)
}
}
mean_ret <- c(mean(return_table[,1]),mean(return_table[,2]))
return(mean_ret)
}
yyyy=2000
mm=7
pro=1
data <- Select.Data(2000,7)
Import()
warnings()
library(ws.data)
Import <- function() {
library("ws.data")
library("dplyr")
library("ggplot2")
library("lubridate")
data(secref)
data(yearly)
data("daily.1998")
data("daily.1999")
data("daily.2000")
data("daily.2001")
data("daily.2002")
data("daily.2003")
data("daily.2004")
data("daily.2005")
data("daily.2006")
data("daily.2007")
}
Import()
data <- Select.Data(2000,7)
for (yyyy in 2000:2007){
JT.Year.Return <- function(yyyy) {
data <- Select.Data(yyyy, 01)
month_tab <- NULL
return_table <- NULL
for (i in 1:12) {
mm <- i
for (pro in 1:6) {
a <- JT.6.6.Return(yyyy,mm,pro,data)
month_tab <- rbind(return_table, a)
}
return_table <- rbind(c(mean(month_tab[,1]),mean(month_tab[,2])]))
month_tab <- NULL
}
return(return_table)
}
JT.Year.Return <- function(yyyy) {
data <- Select.Data(yyyy, 01)
month_tab <- NULL
return_table <- NULL
for (i in 1:12) {
mm <- i
for (pro in 1:6) {
a <- JT.6.6.Return(yyyy,mm,pro,data)
month_tab <- rbind(return_table, a)
}
return_table <- rbind(c(mean(month_tab[,1]),mean(month_tab[,2])]))
month_tab <- NULL
}
return(return_table)
}
JT.Year.Return <- function(yyyy) {
data <- Select.Data(yyyy, 01)
month_tab <- NULL
return_table <- NULL
for (i in 1:12) {
mm <- i
for (pro in 1:6) {
a <- JT.6.6.Return(yyyy,mm,pro,data)
month_tab <- rbind(return_table, a)
}
return_table <- rbind(c(mean(month_tab[,1]),mean(month_tab[,2])))
month_tab <- NULL
}
return(return_table)
}
for (yyyy in 2000:2007){
total <- rbind(total,JT.Year.Return(yyyy))}
total
JT.Year.Return <- function(yyyy) {
data <- Select.Data(yyyy, 01)
month_tab <- NULL
return_table <- NULL
for (i in 1:12) {
mm <- i
for (pro in 1:6) {
a <- JT.6.6.Return(yyyy,mm,pro,data)
month_tab <- rbind(month_tab, a)
}
return_table <- rbind(c(mean(month_tab[,1]),mean(month_tab[,2])))
month_tab <- NULL
}
return(return_table)
}
for (yyyy in 2000:2007){
total <- rbind(total,JT.Year.Return(yyyy))}
total
JT.Year.Return <- function(yyyy) {
data <- Select.Data(yyyy, 01)
month_tab <- NULL
return_table <- NULL
for (i in 1:12) {
mm <- i
for (pro in 1:6) {
a <- JT.6.6.Return(yyyy,mm,pro,data)
month_tab <- rbind(month_tab, a)
}
return_table <- rbind(c(mean(month_tab[,1]),mean(month_tab[,2])))
month_tab <- NULL
}
return(return_table)
}
JT.Year.Return(2000)
View(data)
mm <-
1
pro <- 1
a <- JT.6.6.Return(yyyy,mm,pro,data)
yyyy <- 2000
a <- JT.6.6.Return(yyyy,mm,pro,data)
library("ws.data")
library("dplyr")
library("ggplot2")
library("lubridate")
a <- JT.6.6.Return(yyyy,mm,pro,data)
month_tab <- rbind(month_tab, a)
month_tab
pro <- 2
a <- JT.6.6.Return(yyyy,mm,pro,data)
month_tab <- rbind(month_tab, a)
month_tab
month_tab <- NULL
for (pro in 1:6) {
a <- JT.6.6.Return(yyyy,mm,pro,data)
month_tab <- rbind(month_tab, a)
}
return_table
month_tab
return_table <- rbind(c(mean(month_tab[,1]),mean(month_tab[,2])))
month_tab <- NULL
return_table
mm <- 2
for (pro in 1:6) {
a <- JT.6.6.Return(yyyy,mm,pro,data)
month_tab <- rbind(month_tab, a)
}
return_table <- rbind(c(mean(month_tab[,1]),mean(month_tab[,2])))
month_tab <- NULL
return_table
mm <- 1
library(pack)
a <- JT.6.12.Return(2000,7,1,data)
head(data)
mm <- 7
data1 <- Top.1500(yyyy, mm, pro, data)
data2 <- Data.6.12(yyyy, mm, pro, data1)
Data.6.12 <- function(yyyy, mm, pro, data) {
date1 <- ceiling_date((ymd(paste(yyyy,mm,days_in_month(mm),sep="-")) %m+%
months(-pro)), "month") - duration(1, "days")
date2 <- (ymd(paste(yyyy,mm,01,sep="-")) %m+% months(-pro-11))
data <- filter(data, v.date<= date1, v.date>= date2)
invisible(data)
}
data2 <- Data.6.12(yyyy, mm, pro, data1)
Data.6.12 <- function(yyyy, mm, pro, data) {
date1 <- ceiling_date((ymd(paste(yyyy,mm,days_in_month(mm),sep="-")) %m+%
months(-pro)), "month") - duration(1, "days")
date2 <- (ymd(paste(yyyy,mm,01,sep="-")) %m+% months(-pro-11))
date1 <- as.Date(date1)
date2 <- as.Date(date2)
data <- filter(data, v.date<= date1, v.date>= date2)
invisible(data)
}
data2 <- Data.6.12(yyyy, mm, pro, data1)
rm(data1, data2)
a <- JT.6.12.Return(2000,7,1,data)
a
a <- JT.6.12.Return(2000,7,2,data)
a
a <- JT.Year.Return2(2000)
a
MG.6.6.Return(2000,7,1,data)
a <- MG.6.6.Return(2000,7,1,data)
a
a <- MG.6.6.Return(2000,5,2,data)
a
a <- GH.Return(2000,7,1,data)
a
a <- GH.Return(2000,7,4,data)
a
data1 <- Top.1500(yyyy, mm, pro, data)
data2 <- Data.6.12(yyyy, mm, pro, data1)
data_now <- filter(data1,
month==mm,
year==yyyy)
rank <- GH.Index(data2)
rank
rank <- GH.Index(data2)
rank
GH.Index <- function(data) {
data %>%
select(-top.1500, -m.ind, -id, -year) %>%
group_by(symbol) %>%
arrange(symbol, v.date) %>%
mutate(highest = max(price)) %>%
filter(row_number(v.date)==n()) %>%
ungroup() %>%
mutate(index = price/highest, index_rank = min_rank(index)) %>%
select(symbol, index, index_rank) -> z3
invisible(z3)
}
rank <- GH.Index(data2)
rank
rm(data1, data2)
a <- MG.Year.Return(2000)
a
data1 <- Top.1500(yyyy, mm, pro, data)
data2 <- Data.6.6(yyyy, mm, pro, data1)
data_now <- filter(data1,
month==mm,
year==yyyy)
rank <- MG.Index(data2)
rank
winner_list <- filter(rank, ind_rank<=15)$symbol
loser_list <- filter(rank, ind_rank>(n()-15))$symbol
winner_list
winner_list <- filter(rank, ind_rank<=15)$m.ind
loser_list <- filter(rank, ind_rank>(n()-15))$m.ind
winner_list
data_now  %>%
select(-top.1500, -id, -year) %>%
filter(m.ind %in% winner_list) %>%
group_by(symbol) %>%
arrange(symbol, v.date) %>%
mutate(cum_ret = cumprod(1+tret) - 1) %>%
filter(row_number(v.date) == n()) -> return1
return1
a <- MG.Year.Return(2000)
a
a
"a"
eval("a")
eval(as.symbol("a"))
eval(parse("a"))
?min_rank
a <- Run1()
library(pack)
library(pack)
Import()
a <- NULL
b <- NULL
c <- NULL
d <- NULL
e <- NULL
a <- Run1
a <- NULL
a <- Run1()
b <- Run2()
c <- Run3()
d <- Run4()
e <- Run5()
a
b
c
d
e
write.table(a, file="JT6")
write.table(b,file="JT12")
write.table(c,file="MG6")
write.table(e,file="GHbad")
list.files()
read.csv("JT6")
class(a)
aa <- as.data.frame(a)
bb <- as.data.frame(b)
cc <- as.data.frame(c)
ee <- as.data.frame(e)
write.table(aa, file="JT6")
read.csv(JT6)
read.csv("JT6")
getwd()
a
aa
write.table(aa, file="JT6")
read.csv("JT6",header=TRUE)
aa
write.csv(aa,"JT6")
read.csv("JT6")
write.csv(aa,"JT6",row.names=FALSE,col.names=FALSE)
write.csv(aa,"JT6",row.names=FALSE)
read.csv("JT6")
write.csv(bb,"JT12",row.names=FALSE)
write.csv(cc,"MG6",row.names=FALSE)
write.csv(ee,"GHbad",row.names=FALSE)
Select.Data(2003,8)
data <- Select.Data(2003,8)
wtf <- GH.Return(2003,8,1,data)
wtf
wtf2 <- GH.Return(2003,8,2,data)
wtf2
wtf3 <- GH.Return(2003,8,3,data)
wtf3
pro=3
yyyy=2003
mm=8
data1 <- Top.1500(yyyy, mm, pro, data)
data2 <- Data.6.12(yyyy, mm, pro, data1)
data_now <- filter(data1,
month==mm,
year==yyyy)
rank <- GH.Index(data2)
winner_list <- filter(rank, index_rank<=200)$symbol
loser_list <- filter(rank, index_rank>(n()-200))$symbol
View(rank)
filter(data,symbol="NNN")
filter(data,symbol=="NNN")
?rank
d <- Run4()
library(lubridate)
library(dplyr)
d <- Run4()
library(pack)
Import()
d <- Run4()
e<- Run5()
d
e
?write.csv
write.csv(d, "MG12",row.names=FALSE)
write.csv(e, "GH",row.names=FALSE)
